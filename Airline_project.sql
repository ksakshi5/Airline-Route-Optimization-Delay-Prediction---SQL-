--------------------------------------------------------------------------------
-- Airline Route Optimization & Delay Prediction (Oracle SQL)
-- Schema + tables + sample data
-- Works on Oracle 12c+ (uses IDENTITY columns)
--------------------------------------------------------------------------------

-- -----------------------
-- Clean up (optional)
-- -----------------------
BEGIN
  FOR r IN (SELECT object_name, object_type FROM user_objects
            WHERE object_type IN ('TABLE','SEQUENCE','TRIGGER') 
              AND object_name LIKE 'AR_%') LOOP
    BEGIN
      IF r.object_type = 'TABLE' THEN
        EXECUTE IMMEDIATE 'DROP TABLE ' || r.object_name || ' CASCADE CONSTRAINTS';
      ELSIF r.object_type = 'SEQUENCE' THEN
        EXECUTE IMMEDIATE 'DROP SEQUENCE ' || r.object_name;
      ELSIF r.object_type = 'TRIGGER' THEN
        EXECUTE IMMEDIATE 'DROP TRIGGER ' || r.object_name;
      END IF;
    EXCEPTION WHEN OTHERS THEN NULL;
    END;
  END LOOP;
END;
/
-- Note: the cleanup above looks for objects prefixed with AR_ used below.
-- If you prefer manual control, remove it.

-- -----------------------
-- Airports
-- -----------------------
CREATE TABLE AR_AIRPORTS (
  AIRPORT_ID         NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  IATA               VARCHAR2(3) NOT NULL UNIQUE,
  ICAO               VARCHAR2(4) NOT NULL UNIQUE,
  NAME               VARCHAR2(150) NOT NULL,
  CITY               VARCHAR2(100),
  COUNTRY            VARCHAR2(100),
  LATITUDE           NUMBER(9,6),
  LONGITUDE          NUMBER(9,6),
  TIMEZONE           VARCHAR2(64)
);

-- -----------------------
-- Airlines
-- -----------------------
CREATE TABLE AR_AIRLINES (
  AIRLINE_ID         NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  IATA               VARCHAR2(2),
  ICAO               VARCHAR2(3),
  NAME               VARCHAR2(150) NOT NULL,
  COUNTRY            VARCHAR2(100)
);

CREATE UNIQUE INDEX AR_AIRLINES_IATA_UX ON AR_AIRLINES(IATA);

-- -----------------------
-- Aircraft types
-- -----------------------
CREATE TABLE AR_AIRCRAFT_TYPES (
  AIRCRAFT_TYPE_ID   NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  MODEL              VARCHAR2(50) NOT NULL,
  MANUFACTURER       VARCHAR2(50),
  CAPACITY           NUMBER,
  CRUISE_SPEED_KTS   NUMBER
);

-- -----------------------
-- Aircraft (individual)
-- -----------------------
CREATE TABLE AR_AIRCRAFT (
  AIRCRAFT_ID            NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  REGISTRATION           VARCHAR2(15) NOT NULL UNIQUE,
  AIRCRAFT_TYPE_ID       NUMBER NOT NULL,
  AIRLINE_ID             NUMBER NOT NULL,
  IN_SERVICE_DATE        DATE,
  LAST_MAINTENANCE_DATE  DATE,
  STATUS                 VARCHAR2(20) DEFAULT 'active' CHECK (STATUS IN ('active','maintenance','retired')),
  CONSTRAINT FK_AC_TYPE FOREIGN KEY (AIRCRAFT_TYPE_ID) REFERENCES AR_AIRCRAFT_TYPES(AIRCRAFT_TYPE_ID),
  CONSTRAINT FK_AC_AIRLINE FOREIGN KEY (AIRLINE_ID) REFERENCES AR_AIRLINES(AIRLINE_ID)
);

-- -----------------------
-- Routes (logical origin -> destination)
-- -----------------------
CREATE TABLE AR_ROUTES (
  ROUTE_ID               NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  ORIGIN_AIRPORT_ID      NUMBER NOT NULL,
  DEST_AIRPORT_ID        NUMBER NOT NULL,
  DISTANCE_KM            NUMBER(10,2),
  TYPICAL_FLIGHT_TIME_M  NUMBER,
  CONSTRAINT FK_ROUTE_ORIG FOREIGN KEY (ORIGIN_AIRPORT_ID) REFERENCES AR_AIRPORTS(AIRPORT_ID),
  CONSTRAINT FK_ROUTE_DEST FOREIGN KEY (DEST_AIRPORT_ID) REFERENCES AR_AIRPORTS(AIRPORT_ID),
  CONSTRAINT AR_ROUTES_UQ UNIQUE (ORIGIN_AIRPORT_ID, DEST_AIRPORT_ID)
);

-- -----------------------
-- Scheduled flights (flight plan / timetable)
-- -----------------------
CREATE TABLE AR_SCHEDULED_FLIGHTS (
  SCHEDULED_FLIGHT_ID    NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  AIRLINE_ID             NUMBER NOT NULL,
  FLIGHT_NUMBER          VARCHAR2(16) NOT NULL,
  ROUTE_ID               NUMBER NOT NULL,
  SCHEDULED_DEP_TIME     VARCHAR2(8) NOT NULL,    -- HH24:MI:SS local time
  SCHEDULED_ARR_TIME     VARCHAR2(8) NOT NULL,
  DAYS_OF_WEEK           VARCHAR2(32),            -- e.g. 'Mon,Tue,Wed'
  TYPICAL_BLOCK_MINUTES  NUMBER,
  CONSTRAINT FK_SF_AIRLINE FOREIGN KEY (AIRLINE_ID) REFERENCES AR_AIRLINES(AIRLINE_ID),
  CONSTRAINT FK_SF_ROUTE FOREIGN KEY (ROUTE_ID) REFERENCES AR_ROUTES(ROUTE_ID)
);

CREATE UNIQUE INDEX AR_SF_UQ ON AR_SCHEDULED_FLIGHTS (AIRLINE_ID, FLIGHT_NUMBER, ROUTE_ID);

-- -----------------------
-- Flights (instances)
-- -----------------------
CREATE TABLE AR_FLIGHTS (
  FLIGHT_ID              NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  SCHEDULED_FLIGHT_ID    NUMBER NOT NULL,
  FLIGHT_DATE            DATE NOT NULL,
  AIRCRAFT_ID            NUMBER,
  SCHEDULED_DEPARTURE    TIMESTAMP NOT NULL,
  SCHEDULED_ARRIVAL      TIMESTAMP NOT NULL,
  ACTUAL_DEPARTURE       TIMESTAMP,
  ACTUAL_ARRIVAL         TIMESTAMP,
  STATUS                 VARCHAR2(20) DEFAULT 'scheduled' CHECK (STATUS IN ('scheduled','departed','arrived','cancelled','diverted')),
  CREATED_AT             TIMESTAMP DEFAULT SYSTIMESTAMP,
  CONSTRAINT FK_F_SF FOREIGN KEY (SCHEDULED_FLIGHT_ID) REFERENCES AR_SCHEDULED_FLIGHTS(SCHEDULED_FLIGHT_ID),
  CONSTRAINT FK_F_AC FOREIGN KEY (AIRCRAFT_ID) REFERENCES AR_AIRCRAFT(AIRCRAFT_ID)
);

CREATE INDEX AR_FLIGHTS_DATE_IDX ON AR_FLIGHTS(FLIGHT_DATE);

-- -----------------------
-- Crew
-- -----------------------
CREATE TABLE AR_CREW (
  CREW_ID            NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  AIRLINE_ID         NUMBER NOT NULL,
  NAME               VARCHAR2(120),
  ROLE               VARCHAR2(30) CHECK (ROLE IN ('pilot','co-pilot','flight_attendant','engineer','dispatcher')),
  RANK               VARCHAR2(50),
  CONSTRAINT FK_CREW_AIRLINE FOREIGN KEY (AIRLINE_ID) REFERENCES AR_AIRLINES(AIRLINE_ID)
);

-- -----------------------
-- Crew assignments (flight crew)
-- -----------------------
CREATE TABLE AR_CREW_ASSIGNMENTS (
  ASSIGNMENT_ID      NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  FLIGHT_ID          NUMBER NOT NULL,
  CREW_ID            NUMBER NOT NULL,
  ASSIGNED_ROLE      VARCHAR2(50),
  CONSTRAINT FK_CA_FLIGHT FOREIGN KEY (FLIGHT_ID) REFERENCES AR_FLIGHTS(FLIGHT_ID) ON DELETE CASCADE,
  CONSTRAINT FK_CA_CREW FOREIGN KEY (CREW_ID) REFERENCES AR_CREW(CREW_ID)
);

-- -----------------------
-- Weather reports
-- -----------------------
CREATE TABLE AR_WEATHER_REPORTS (
  WEATHER_ID         NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  AIRPORT_ID         NUMBER NOT NULL,
  REPORT_TIME        TIMESTAMP NOT NULL,
  TEMPERATURE_C      NUMBER(5,1),
  WIND_SPEED_KTS     NUMBER,
  WIND_DIR_DEG       NUMBER,
  VISIBILITY_KM      NUMBER(6,2),
  PRECIPITATION      VARCHAR2(16) DEFAULT 'none' CHECK (PRECIPITATION IN ('none','rain','snow','storm','hail')),
  REMARKS            VARCHAR2(255),
  CONSTRAINT FK_WR_AIRPORT FOREIGN KEY (AIRPORT_ID) REFERENCES AR_AIRPORTS(AIRPORT_ID)
);

CREATE INDEX AR_WEATHER_AIRPORT_TIME_IDX ON AR_WEATHER_REPORTS(AIRPORT_ID, REPORT_TIME);

-- -----------------------
-- Delays
-- -----------------------
CREATE TABLE AR_DELAYS (
  DELAY_ID           NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  FLIGHT_ID          NUMBER NOT NULL,
  DELAY_MINUTES      NUMBER NOT NULL,
  DELAY_TYPE         VARCHAR2(32) NOT NULL CHECK (DELAY_TYPE IN ('airline','weather','security','air_traffic','technical','crew','other')),
  DESCRIPTION        VARCHAR2(400),
  RECORDED_AT        TIMESTAMP DEFAULT SYSTIMESTAMP,
  CONSTRAINT FK_D_FLIGHT FOREIGN KEY (FLIGHT_ID) REFERENCES AR_FLIGHTS(FLIGHT_ID) ON DELETE CASCADE
);

-- -----------------------
-- Maintenance records
-- -----------------------
CREATE TABLE AR_MAINTENANCE (
  MAINTENANCE_ID     NUMBER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  AIRCRAFT_ID        NUMBER NOT NULL,
  MAINTENANCE_DATE   DATE NOT NULL,
  MAINTENANCE_TYPE   VARCHAR2(100),
  HOURS_DOWNTIME     NUMBER,
  NOTES              VARCHAR2(400),
  CONSTRAINT FK_M_AIRCRAFT FOREIGN KEY (AIRCRAFT_ID) REFERENCES AR_AIRCRAFT(AIRCRAFT_ID) ON DELETE CASCADE
);

-- -----------------------
-- Index on routes origin for analytics
-- -----------------------
CREATE INDEX AR_ROUTES_ORIG_IDX ON AR_ROUTES(ORIGIN_AIRPORT_ID);

-- -----------------------
-- Sample data inserts
-- -----------------------

-- Airports
INSERT INTO AR_AIRPORTS (IATA, ICAO, NAME, CITY, COUNTRY, LATITUDE, LONGITUDE, TIMEZONE) VALUES
('DEL','VIDP','Indira Gandhi Intl Airport','New Delhi','India', 28.556162, 77.100281, 'Asia/Kolkata');
INSERT INTO AR_AIRPORTS (IATA, ICAO, NAME, CITY, COUNTRY, LATITUDE, LONGITUDE, TIMEZONE) VALUES
('BOM','VABB','Chhatrapati Shivaji Intl','Mumbai','India', 19.089559, 72.865614, 'Asia/Kolkata');
INSERT INTO AR_AIRPORTS (IATA, ICAO, NAME, CITY, COUNTRY, LATITUDE, LONGITUDE, TIMEZONE) VALUES
('BLR','VOBL','Kempegowda Intl','Bengaluru','India', 13.198639, 77.706322, 'Asia/Kolkata');
INSERT INTO AR_AIRPORTS (IATA, ICAO, NAME, CITY, COUNTRY, LATITUDE, LONGITUDE, TIMEZONE) VALUES
('HYD','VOHS','Rajiv Gandhi Intl','Hyderabad','India', 17.240263, 78.429714, 'Asia/Kolkata');
INSERT INTO AR_AIRPORTS (IATA, ICAO, NAME, CITY, COUNTRY, LATITUDE, LONGITUDE, TIMEZONE) VALUES
('DXB','OMDB','Dubai Intl','Dubai','UAE', 25.253174, 55.365673, 'Asia/Dubai');
INSERT INTO AR_AIRPORTS (IATA, ICAO, NAME, CITY, COUNTRY, LATITUDE, LONGITUDE, TIMEZONE) VALUES
('LHR','EGLL','Heathrow','London','UK', 51.470020, -0.454295, 'Europe/London');

-- Airlines
INSERT INTO AR_AIRLINES (IATA, ICAO, NAME, COUNTRY) VALUES ('AI','AIC','Air India','India');
INSERT INTO AR_AIRLINES (IATA, ICAO, NAME, COUNTRY) VALUES ('6E','IBE','IndiGo','India');
INSERT INTO AR_AIRLINES (IATA, ICAO, NAME, COUNTRY) VALUES ('EK','UAE','Emirates','UAE');

-- Aircraft types
INSERT INTO AR_AIRCRAFT_TYPES (MODEL, MANUFACTURER, CAPACITY, CRUISE_SPEED_KTS) VALUES ('A320','Airbus',180,470);
INSERT INTO AR_AIRCRAFT_TYPES (MODEL, MANUFACTURER, CAPACITY, CRUISE_SPEED_KTS) VALUES ('B737-800','Boeing',189,450);
INSERT INTO AR_AIRCRAFT_TYPES (MODEL, MANUFACTURER, CAPACITY, CRUISE_SPEED_KTS) VALUES ('A350','Airbus',300,480);

-- Aircraft
INSERT INTO AR_AIRCRAFT (REGISTRATION, AIRCRAFT_TYPE_ID, AIRLINE_ID, IN_SERVICE_DATE, LAST_MAINTENANCE_DATE, STATUS)
 VALUES ('VT-ANI', 1, 1, TO_DATE('2016-05-12','YYYY-MM-DD'), TO_DATE('2025-11-10','YYYY-MM-DD'), 'active');

INSERT INTO AR_AIRCRAFT (REGISTRATION, AIRCRAFT_TYPE_ID, AIRLINE_ID, IN_SERVICE_DATE, LAST_MAINTENANCE_DATE, STATUS)
 VALUES ('VT-EXM', 2, 2, TO_DATE('2018-03-01','YYYY-MM-DD'), TO_DATE('2025-10-20','YYYY-MM-DD'), 'active');

INSERT INTO AR_AIRCRAFT (REGISTRATION, AIRCRAFT_TYPE_ID, AIRLINE_ID, IN_SERVICE_DATE, LAST_MAINTENANCE_DATE, STATUS)
 VALUES ('VT-ADO', 1, 2, TO_DATE('2019-07-23','YYYY-MM-DD'), TO_DATE('2025-09-30','YYYY-MM-DD'), 'active');

INSERT INTO AR_AIRCRAFT (REGISTRATION, AIRCRAFT_TYPE_ID, AIRLINE_ID, IN_SERVICE_DATE, LAST_MAINTENANCE_DATE, STATUS)
 VALUES ('A6-EM1', 3, 3, TO_DATE('2020-02-15','YYYY-MM-DD'), TO_DATE('2025-11-15','YYYY-MM-DD'), 'active');

INSERT INTO AR_AIRCRAFT (REGISTRATION, AIRCRAFT_TYPE_ID, AIRLINE_ID, IN_SERVICE_DATE, LAST_MAINTENANCE_DATE, STATUS)
 VALUES ('VT-MTN', 2, 1, TO_DATE('2015-01-05','YYYY-MM-DD'), TO_DATE('2024-12-01','YYYY-MM-DD'), 'maintenance');

-- Routes (use airport IDs by selecting them or rely on identity order above)
-- For clarity, we use subqueries to reference inserted airports
INSERT INTO AR_ROUTES (ORIGIN_AIRPORT_ID, DEST_AIRPORT_ID, DISTANCE_KM, TYPICAL_FLIGHT_TIME_M)
 VALUES ((SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='DEL'), (SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='BOM'), 1150, 120);

INSERT INTO AR_ROUTES (ORIGIN_AIRPORT_ID, DEST_AIRPORT_ID, DISTANCE_KM, TYPICAL_FLIGHT_TIME_M)
 VALUES ((SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='DEL'), (SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='BLR'), 2150, 165);

INSERT INTO AR_ROUTES (ORIGIN_AIRPORT_ID, DEST_AIRPORT_ID, DISTANCE_KM, TYPICAL_FLIGHT_TIME_M)
 VALUES ((SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='BOM'), (SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='BLR'), 980, 110);

INSERT INTO AR_ROUTES (ORIGIN_AIRPORT_ID, DEST_AIRPORT_ID, DISTANCE_KM, TYPICAL_FLIGHT_TIME_M)
 VALUES ((SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='BLR'), (SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='HYD'), 630, 90);

INSERT INTO AR_ROUTES (ORIGIN_AIRPORT_ID, DEST_AIRPORT_ID, DISTANCE_KM, TYPICAL_FLIGHT_TIME_M)
 VALUES ((SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='DEL'), (SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='DXB'), 2720, 240);

INSERT INTO AR_ROUTES (ORIGIN_AIRPORT_ID, DEST_AIRPORT_ID, DISTANCE_KM, TYPICAL_FLIGHT_TIME_M)
 VALUES ((SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='DXB'), (SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='LHR'), 5500, 420);

-- Scheduled flights
INSERT INTO AR_SCHEDULED_FLIGHTS (AIRLINE_ID, FLIGHT_NUMBER, ROUTE_ID, SCHEDULED_DEP_TIME, SCHEDULED_ARR_TIME, DAYS_OF_WEEK, TYPICAL_BLOCK_MINUTES)
 VALUES ((SELECT AIRLINE_ID FROM AR_AIRLINES WHERE IATA='6E'), '6E-101', (SELECT ROUTE_ID FROM AR_ROUTES WHERE ORIGIN_AIRPORT_ID=(SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='DEL') AND DEST_AIRPORT_ID=(SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='BOM')), '06:30:00','08:30:00','Mon,Tue,Wed,Thu,Fri,Sat,Sun', 120);

INSERT INTO AR_SCHEDULED_FLIGHTS (AIRLINE_ID, FLIGHT_NUMBER, ROUTE_ID, SCHEDULED_DEP_TIME, SCHEDULED_ARR_TIME, DAYS_OF_WEEK, TYPICAL_BLOCK_MINUTES)
 VALUES ((SELECT AIRLINE_ID FROM AR_AIRLINES WHERE IATA='AI'), 'AI-201', (SELECT ROUTE_ID FROM AR_ROUTES WHERE ORIGIN_AIRPORT_ID=(SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='DEL') AND DEST_AIRPORT_ID=(SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='BOM')), '14:00:00','16:00:00','Mon,Tue,Wed,Thu,Fri,Sat,Sun', 120);

INSERT INTO AR_SCHEDULED_FLIGHTS (AIRLINE_ID, FLIGHT_NUMBER, ROUTE_ID, SCHEDULED_DEP_TIME, SCHEDULED_ARR_TIME, DAYS_OF_WEEK, TYPICAL_BLOCK_MINUTES)
 VALUES ((SELECT AIRLINE_ID FROM AR_AIRLINES WHERE IATA='6E'), '6E-303', (SELECT ROUTE_ID FROM AR_ROUTES WHERE ORIGIN_AIRPORT_ID=(SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='DEL') AND DEST_AIRPORT_ID=(SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='BLR')), '09:00:00','11:45:00','Mon,Tue,Wed,Thu,Fri,Sat,Sun', 165);

INSERT INTO AR_SCHEDULED_FLIGHTS (AIRLINE_ID, FLIGHT_NUMBER, ROUTE_ID, SCHEDULED_DEP_TIME, SCHEDULED_ARR_TIME, DAYS_OF_WEEK, TYPICAL_BLOCK_MINUTES)
 VALUES ((SELECT AIRLINE_ID FROM AR_AIRLINES WHERE IATA='EK'), 'EK-501', (SELECT ROUTE_ID FROM AR_ROUTES WHERE ORIGIN_AIRPORT_ID=(SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='DEL') AND DEST_AIRPORT_ID=(SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='DXB')), '02:00:00','06:00:00','Mon,Wed,Fri,Sun', 240);

INSERT INTO AR_SCHEDULED_FLIGHTS (AIRLINE_ID, FLIGHT_NUMBER, ROUTE_ID, SCHEDULED_DEP_TIME, SCHEDULED_ARR_TIME, DAYS_OF_WEEK, TYPICAL_BLOCK_MINUTES)
 VALUES ((SELECT AIRLINE_ID FROM AR_AIRLINES WHERE IATA='AI'), 'AI-777', (SELECT ROUTE_ID FROM AR_ROUTES WHERE ORIGIN_AIRPORT_ID=(SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='DXB') AND DEST_AIRPORT_ID=(SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='LHR')), '22:30:00','06:30:00','Mon,Thu,Sat', 420);

-- Flights (instances)
-- Note: using TIMESTAMP literals via TO_TIMESTAMP for scheduled/actual times
INSERT INTO AR_FLIGHTS (SCHEDULED_FLIGHT_ID, FLIGHT_DATE, AIRCRAFT_ID, SCHEDULED_DEPARTURE, SCHEDULED_ARRIVAL, STATUS)
 VALUES ((SELECT SCHEDULED_FLIGHT_ID FROM AR_SCHEDULED_FLIGHTS WHERE FLIGHT_NUMBER='6E-101' AND ROWNUM=1),
         TO_DATE('2025-11-25','YYYY-MM-DD'),
         (SELECT AIRCRAFT_ID FROM AR_AIRCRAFT WHERE REGISTRATION='VT-EXM'),
         TO_TIMESTAMP('2025-11-25 06:30:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-25 08:30:00','YYYY-MM-DD HH24:MI:SS'),'arrived');

INSERT INTO AR_FLIGHTS (SCHEDULED_FLIGHT_ID, FLIGHT_DATE, AIRCRAFT_ID, SCHEDULED_DEPARTURE, SCHEDULED_ARRIVAL, ACTUAL_DEPARTURE, ACTUAL_ARRIVAL, STATUS)
 VALUES ((SELECT SCHEDULED_FLIGHT_ID FROM AR_SCHEDULED_FLIGHTS WHERE FLIGHT_NUMBER='6E-101' AND ROWNUM=1),
         TO_DATE('2025-11-26','YYYY-MM-DD'),
         (SELECT AIRCRAFT_ID FROM AR_AIRCRAFT WHERE REGISTRATION='VT-EXM'),
         TO_TIMESTAMP('2025-11-26 06:30:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-26 08:55:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-26 06:40:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-26 09:00:00','YYYY-MM-DD HH24:MI:SS'),
         'arrived');

INSERT INTO AR_FLIGHTS (SCHEDULED_FLIGHT_ID, FLIGHT_DATE, AIRCRAFT_ID, SCHEDULED_DEPARTURE, SCHEDULED_ARRIVAL, ACTUAL_DEPARTURE, ACTUAL_ARRIVAL, STATUS)
 VALUES ((SELECT SCHEDULED_FLIGHT_ID FROM AR_SCHEDULED_FLIGHTS WHERE FLIGHT_NUMBER='AI-201' AND ROWNUM=1),
         TO_DATE('2025-11-25','YYYY-MM-DD'),
         (SELECT AIRCRAFT_ID FROM AR_AIRCRAFT WHERE REGISTRATION='VT-ANI'),
         TO_TIMESTAMP('2025-11-25 14:00:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-25 16:10:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-25 14:05:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-25 16:10:00','YYYY-MM-DD HH24:MI:SS'),
         'arrived');

INSERT INTO AR_FLIGHTS (SCHEDULED_FLIGHT_ID, FLIGHT_DATE, AIRCRAFT_ID, SCHEDULED_DEPARTURE, SCHEDULED_ARRIVAL, STATUS)
 VALUES ((SELECT SCHEDULED_FLIGHT_ID FROM AR_SCHEDULED_FLIGHTS WHERE FLIGHT_NUMBER='6E-303' AND ROWNUM=1),
         TO_DATE('2025-11-25','YYYY-MM-DD'),
         (SELECT AIRCRAFT_ID FROM AR_AIRCRAFT WHERE REGISTRATION='A6-EM1'),
         TO_TIMESTAMP('2025-11-25 09:00:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-25 11:45:00','YYYY-MM-DD HH24:MI:SS'),
         'departed');

INSERT INTO AR_FLIGHTS (SCHEDULED_FLIGHT_ID, FLIGHT_DATE, AIRCRAFT_ID, SCHEDULED_DEPARTURE, SCHEDULED_ARRIVAL, ACTUAL_DEPARTURE, ACTUAL_ARRIVAL, STATUS)
 VALUES ((SELECT SCHEDULED_FLIGHT_ID FROM AR_SCHEDULED_FLIGHTS WHERE FLIGHT_NUMBER='6E-303' AND ROWNUM=1),
         TO_DATE('2025-11-26','YYYY-MM-DD'),
         (SELECT AIRCRAFT_ID FROM AR_AIRCRAFT WHERE REGISTRATION='A6-EM1'),
         TO_TIMESTAMP('2025-11-26 09:00:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-26 11:50:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-26 09:05:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-26 11:55:00','YYYY-MM-DD HH24:MI:SS'),
         'arrived');

INSERT INTO AR_FLIGHTS (SCHEDULED_FLIGHT_ID, FLIGHT_DATE, AIRCRAFT_ID, SCHEDULED_DEPARTURE, SCHEDULED_ARRIVAL, STATUS)
 VALUES ((SELECT SCHEDULED_FLIGHT_ID FROM AR_SCHEDULED_FLIGHTS WHERE FLIGHT_NUMBER='EK-501' AND ROWNUM=1),
         TO_DATE('2025-11-24','YYYY-MM-DD'),
         (SELECT AIRCRAFT_ID FROM AR_AIRCRAFT WHERE REGISTRATION='A6-EM1'),
         TO_TIMESTAMP('2025-11-24 02:00:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-24 06:00:00','YYYY-MM-DD HH24:MI:SS'),
         'cancelled');

INSERT INTO AR_FLIGHTS (SCHEDULED_FLIGHT_ID, FLIGHT_DATE, AIRCRAFT_ID, SCHEDULED_DEPARTURE, SCHEDULED_ARRIVAL, ACTUAL_DEPARTURE, ACTUAL_ARRIVAL, STATUS)
 VALUES ((SELECT SCHEDULED_FLIGHT_ID FROM AR_SCHEDULED_FLIGHTS WHERE FLIGHT_NUMBER='AI-777' AND ROWNUM=1),
         TO_DATE('2025-11-22','YYYY-MM-DD'),
         (SELECT AIRCRAFT_ID FROM AR_AIRCRAFT WHERE REGISTRATION='A6-EM1'),
         TO_TIMESTAMP('2025-11-22 22:30:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-23 06:30:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-22 22:35:00','YYYY-MM-DD HH24:MI:SS'),
         TO_TIMESTAMP('2025-11-23 07:40:00','YYYY-MM-DD HH24:MI:SS'),
         'arrived');

-- Crew
INSERT INTO AR_CREW (AIRLINE_ID, NAME, ROLE, RANK) VALUES ((SELECT AIRLINE_ID FROM AR_AIRLINES WHERE IATA='6E'), 'Rahul Sharma', 'pilot', 'Captain');
INSERT INTO AR_CREW (AIRLINE_ID, NAME, ROLE, RANK) VALUES ((SELECT AIRLINE_ID FROM AR_AIRLINES WHERE IATA='6E'), 'Aisha Khan', 'co-pilot', 'First Officer');
INSERT INTO AR_CREW (AIRLINE_ID, NAME, ROLE, RANK) VALUES ((SELECT AIRLINE_ID FROM AR_AIRLINES WHERE IATA='AI'), 'Vikram Patel', 'pilot', 'Captain');
INSERT INTO AR_CREW (AIRLINE_ID, NAME, ROLE, RANK) VALUES ((SELECT AIRLINE_ID FROM AR_AIRLINES WHERE IATA='AI'), 'Meera Rao', 'flight_attendant', NULL);
INSERT INTO AR_CREW (AIRLINE_ID, NAME, ROLE, RANK) VALUES ((SELECT AIRLINE_ID FROM AR_AIRLINES WHERE IATA='EK'), 'Omar Al-Farsi', 'pilot', 'Captain');
INSERT INTO AR_CREW (AIRLINE_ID, NAME, ROLE, RANK) VALUES ((SELECT AIRLINE_ID FROM AR_AIRLINES WHERE IATA='EK'), 'Sara Ahmed', 'flight_attendant', NULL);

-- Crew assignments -- reference flights by selecting by rownum/ROWID pattern for demo
INSERT INTO AR_CREW_ASSIGNMENTS (FLIGHT_ID, CREW_ID, ASSIGNED_ROLE)
 VALUES ((SELECT FLIGHT_ID FROM (SELECT FLIGHT_ID FROM AR_FLIGHTS ORDER BY FLIGHT_ID) WHERE ROWNUM=1), (SELECT CREW_ID FROM AR_CREW WHERE NAME='Rahul Sharma'), 'Captain');

INSERT INTO AR_CREW_ASSIGNMENTS (FLIGHT_ID, CREW_ID, ASSIGNED_ROLE)
 VALUES ((SELECT FLIGHT_ID FROM (SELECT FLIGHT_ID FROM AR_FLIGHTS ORDER BY FLIGHT_ID) WHERE ROWNUM=1), (SELECT CREW_ID FROM AR_CREW WHERE NAME='Aisha Khan'), 'First Officer');

INSERT INTO AR_CREW_ASSIGNMENTS (FLIGHT_ID, CREW_ID, ASSIGNED_ROLE)
 VALUES ((SELECT FLIGHT_ID FROM (SELECT FLIGHT_ID FROM AR_FLIGHTS ORDER BY FLIGHT_ID) WHERE ROWNUM=2), (SELECT CREW_ID FROM AR_CREW WHERE NAME='Vikram Patel'), 'Captain');

-- Weather reports
INSERT INTO AR_WEATHER_REPORTS (AIRPORT_ID, REPORT_TIME, TEMPERATURE_C, WIND_SPEED_KTS, WIND_DIR_DEG, VISIBILITY_KM, PRECIPITATION, REMARKS)
 VALUES ((SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='DEL'), TO_TIMESTAMP('2025-11-25 05:00:00','YYYY-MM-DD HH24:MI:SS'), 18.5, 10, 180, 10.00, 'none', 'Calm morning');

INSERT INTO AR_WEATHER_REPORTS (AIRPORT_ID, REPORT_TIME, TEMPERATURE_C, WIND_SPEED_KTS, WIND_DIR_DEG, VISIBILITY_KM, PRECIPITATION, REMARKS)
 VALUES ((SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='BOM'), TO_TIMESTAMP('2025-11-25 07:00:00','YYYY-MM-DD HH24:MI:SS'), 26.0, 8, 200, 8.00, 'rain', 'Light rain affecting taxiways');

INSERT INTO AR_WEATHER_REPORTS (AIRPORT_ID, REPORT_TIME, TEMPERATURE_C, WIND_SPEED_KTS, WIND_DIR_DEG, VISIBILITY_KM, PRECIPITATION, REMARKS)
 VALUES ((SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='BLR'), TO_TIMESTAMP('2025-11-25 08:30:00','YYYY-MM-DD HH24:MI:SS'), 22.0, 12, 150, 10.00, 'none', 'Good visibility');

INSERT INTO AR_WEATHER_REPORTS (AIRPORT_ID, REPORT_TIME, TEMPERATURE_C, WIND_SPEED_KTS, WIND_DIR_DEG, VISIBILITY_KM, PRECIPITATION, REMARKS)
 VALUES ((SELECT AIRPORT_ID FROM AR_AIRPORTS WHERE IATA='DXB'), TO_TIMESTAMP('2025-11-24 01:30:00','YYYY-MM-DD HH24:MI:SS'), 28.0, 20, 250, 10.00, 'none', 'Windy at Dubai early hours');

-- Delays
INSERT INTO AR_DELAYS (FLIGHT_ID, DELAY_MINUTES, DELAY_TYPE, DESCRIPTION, RECORDED_AT)
 VALUES ((SELECT FLIGHT_ID FROM (SELECT FLIGHT_ID FROM AR_FLIGHTS ORDER BY FLIGHT_ID) WHERE ROWNUM=2), 25, 'air_traffic', 'ATC holding due to congestion', SYSTIMESTAMP);

INSERT INTO AR_DELAYS (FLIGHT_ID, DELAY_MINUTES, DELAY_TYPE, DESCRIPTION, RECORDED_AT)
 VALUES ((SELECT FLIGHT_ID FROM (SELECT FLIGHT_ID FROM AR_FLIGHTS ORDER BY FLIGHT_ID) WHERE ROWNUM=3), 15, 'technical', 'Minor hydraulic indication; deferred to maintenance after landing', SYSTIMESTAMP);

INSERT INTO AR_DELAYS (FLIGHT_ID, DELAY_MINUTES, DELAY_TYPE, DESCRIPTION, RECORDED_AT)
 VALUES ((SELECT FLIGHT_ID FROM (SELECT FLIGHT_ID FROM AR_FLIGHTS ORDER BY FLIGHT_ID) WHERE ROWNUM=6), 0, 'weather', 'Flight cancelled due to storm', SYSTIMESTAMP);

INSERT INTO AR_DELAYS (FLIGHT_ID, DELAY_MINUTES, DELAY_TYPE, DESCRIPTION, RECORDED_AT)
 VALUES ((SELECT FLIGHT_ID FROM (SELECT FLIGHT_ID FROM AR_FLIGHTS ORDER BY FLIGHT_ID DESC) WHERE ROWNUM=1), 90, 'crew', 'Crew duty-time exceeded; replacement required', SYSTIMESTAMP);

-- Maintenance
INSERT INTO AR_MAINTENANCE (AIRCRAFT_ID, MAINTENANCE_DATE, MAINTENANCE_TYPE, HOURS_DOWNTIME, NOTES)
 VALUES ((SELECT AIRCRAFT_ID FROM AR_AIRCRAFT WHERE REGISTRATION='VT-MTN'), TO_DATE('2024-12-01','YYYY-MM-DD'), 'A-Check', 8, 'Routine A-check; replaced worn tire');

INSERT INTO AR_MAINTENANCE (AIRCRAFT_ID, MAINTENANCE_DATE, MAINTENANCE_TYPE, HOURS_DOWNTIME, NOTES)
 VALUES ((SELECT AIRCRAFT_ID FROM AR_AIRCRAFT WHERE REGISTRATION='VT-ANI'), TO_DATE('2025-11-10','YYYY-MM-DD'), 'B-Check', 24, 'Scheduled B-check; nav software patch');

INSERT INTO AR_MAINTENANCE (AIRCRAFT_ID, MAINTENANCE_DATE, MAINTENANCE_TYPE, HOURS_DOWNTIME, NOTES)
 VALUES ((SELECT AIRCRAFT_ID FROM AR_AIRCRAFT WHERE REGISTRATION='A6-EM1'), TO_DATE('2025-11-15','YYYY-MM-DD'), 'A-Check', 6, 'Normal check');

COMMIT;
